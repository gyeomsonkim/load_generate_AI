{
  "info": {
    "name": "Pathfinding Server API - Phase 2",
    "description": "AI 기반 길찾기 서버 API (Phase 1 + Phase 2)\n\n## Phase 1 기능\n- 지도 이미지 업로드 및 전처리\n- 보행 가능 영역 자동 감지\n\n## Phase 2 기능 (NEW)\n- A* 알고리즘 기반 경로 찾기\n- 다중 경유지 경로\n- 대체 경로 제안\n- 경로 캐싱 및 최적화",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "api_prefix",
      "value": "/api/v1",
      "type": "string"
    },
    {
      "key": "map_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "path_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Phase 1: Maps Management",
      "item": [
        {
          "name": "Upload Map",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": []
                },
                {
                  "key": "name",
                  "value": "Test Park Map",
                  "type": "text"
                },
                {
                  "key": "description",
                  "value": "테스트용 공원 지도",
                  "type": "text"
                },
                {
                  "key": "map_type",
                  "value": "park",
                  "type": "text"
                },
                {
                  "key": "scale_meters_per_pixel",
                  "value": "0.5",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/maps/upload",
              "host": ["{{base_url}}"],
              "path": ["{{api_prefix}}", "maps", "upload"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "pm.environment.set(\"map_id\", jsonData.id);"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Get Map",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/maps/{{map_id}}",
              "host": ["{{base_url}}"],
              "path": ["{{api_prefix}}", "maps", "{{map_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Phase 2: Pathfinding (NEW)",
      "item": [
        {
          "name": "Find Route - 단일 경로 찾기",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"map_id\": \"{{map_id}}\",\n  \"start\": [0.2, 0.3],\n  \"end\": [0.8, 0.7],\n  \"options\": {\n    \"smoothing_level\": \"medium\",\n    \"use_cache\": true\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/pathfinding/route",
              "host": ["{{base_url}}"],
              "path": ["{{api_prefix}}", "pathfinding", "route"]
            },
            "description": "A* 알고리즘을 사용한 최적 경로 찾기\n\n**입력:**\n- map_id: 지도 ID\n- start: 시작 좌표 [x, y] (0-1 정규화)\n- end: 종료 좌표 [x, y] (0-1 정규화)\n- options: 추가 옵션\n  - smoothing_level: none, low, medium, high\n  - use_cache: 캐시 사용 여부\n\n**출력:**\n- polyline: 경로 좌표 배열\n- svg_path: SVG 경로 문자열\n- distance_meters: 실제 거리(미터)\n- estimated_time_seconds: 예상 시간(초)\n- difficulty: easy, moderate, hard"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "var jsonData = pm.response.json();",
                  "pm.environment.set(\"path_id\", jsonData.path_id);",
                  "",
                  "pm.test(\"Path found successfully\", function () {",
                  "    pm.expect(jsonData).to.have.property('polyline');",
                  "    pm.expect(jsonData.polyline).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Find Multi Route - 다중 경유지",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"map_id\": \"{{map_id}}\",\n  \"points\": [\n    [0.2, 0.2],\n    [0.5, 0.3],\n    [0.7, 0.6],\n    [0.8, 0.8]\n  ],\n  \"optimize_order\": true,\n  \"return_to_start\": false,\n  \"options\": {}\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/pathfinding/multi-route",
              "host": ["{{base_url}}"],
              "path": ["{{api_prefix}}", "pathfinding", "multi-route"]
            },
            "description": "여러 경유지를 거치는 경로 찾기\n\n**입력:**\n- points: 경유할 지점들 (최소 2개)\n- optimize_order: 경유 순서 최적화\n- return_to_start: 시작점 복귀 여부\n\n**출력:**\n- segments: 구간별 경로 정보\n- total_distance_meters: 총 거리\n- total_time_seconds: 총 시간"
          }
        },
        {
          "name": "Find Alternatives - 대체 경로",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/pathfinding/alternatives?map_id={{map_id}}&start_x=0.2&start_y=0.3&end_x=0.8&end_y=0.7&max_alternatives=3",
              "host": ["{{base_url}}"],
              "path": ["{{api_prefix}}", "pathfinding", "alternatives"],
              "query": [
                {
                  "key": "map_id",
                  "value": "{{map_id}}"
                },
                {
                  "key": "start_x",
                  "value": "0.2"
                },
                {
                  "key": "start_y",
                  "value": "0.3"
                },
                {
                  "key": "end_x",
                  "value": "0.8"
                },
                {
                  "key": "end_y",
                  "value": "0.7"
                },
                {
                  "key": "max_alternatives",
                  "value": "3"
                }
              ]
            },
            "description": "메인 경로와 대체 경로들 찾기\n\n**쿼리 파라미터:**\n- map_id: 지도 ID\n- start_x, start_y: 시작 좌표\n- end_x, end_y: 종료 좌표\n- max_alternatives: 최대 대체 경로 수\n\n**출력:**\n- main_route: 최적 경로\n- alternatives: 대체 경로 배열"
          }
        },
        {
          "name": "Get Pathfinding History",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/pathfinding/history/{{map_id}}?limit=10",
              "host": ["{{base_url}}"],
              "path": ["{{api_prefix}}", "pathfinding", "history", "{{map_id}}"],
              "query": [
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "특정 지도의 길찾기 기록 조회"
          }
        },
        {
          "name": "Clear Cache",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/pathfinding/cache/{{map_id}}",
              "host": ["{{base_url}}"],
              "path": ["{{api_prefix}}", "pathfinding", "cache", "{{map_id}}"]
            },
            "description": "특정 지도의 경로 캐시 삭제"
          }
        }
      ]
    },
    {
      "name": "Test Scenarios",
      "item": [
        {
          "name": "Scenario: 완전한 워크플로우",
          "item": [
            {
              "name": "1. 지도 업로드",
              "request": {
                "method": "POST",
                "body": {
                  "mode": "formdata",
                  "formdata": [
                    {
                      "key": "file",
                      "type": "file",
                      "src": []
                    },
                    {
                      "key": "name",
                      "value": "Campus Map",
                      "type": "text"
                    },
                    {
                      "key": "map_type",
                      "value": "campus",
                      "type": "text"
                    },
                    {
                      "key": "scale_meters_per_pixel",
                      "value": "0.2",
                      "type": "text"
                    }
                  ]
                },
                "url": {
                  "raw": "{{base_url}}{{api_prefix}}/maps/upload",
                  "host": ["{{base_url}}"],
                  "path": ["{{api_prefix}}", "maps", "upload"]
                }
              }
            },
            {
              "name": "2. 전처리 대기 (10초)",
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      "setTimeout(function() {}, 10000);"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{base_url}}{{api_prefix}}/maps/{{map_id}}",
                  "host": ["{{base_url}}"],
                  "path": ["{{api_prefix}}", "maps", "{{map_id}}"]
                }
              }
            },
            {
              "name": "3. 경로 찾기",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"map_id\": \"{{map_id}}\",\n  \"start\": [0.1, 0.1],\n  \"end\": [0.9, 0.9],\n  \"options\": {\n    \"smoothing_level\": \"high\"\n  }\n}"
                },
                "url": {
                  "raw": "{{base_url}}{{api_prefix}}/pathfinding/route",
                  "host": ["{{base_url}}"],
                  "path": ["{{api_prefix}}", "pathfinding", "route"]
                }
              }
            }
          ]
        }
      ]
    }
  ]
}